<svg 
  width="100%" 
  height="100%" 
  viewPort="0 0 100 100"
  xmlns="http://www.w3.org/2000/svg"
>
  <script 
    type="application/ecmascript"
  >
    <![CDATA[

      window.running = false

      const svg = document.documentElement      
      const c = document.createElementNS("http://www.w3.org/2000/svg", "circle")
      c.setAttribute('r', '20%')
      c.setAttribute('cx', '0%')
      c.setAttribute('cy', '0%')
      c.setAttribute('fill', '#000000')
      svg.appendChild(c)

      function animar() {

        const newX = (Math.random() * 100)
        const newY = (Math.random() * 100)

        c.setAttribute('cx', newX + '%')
        c.setAttribute('cy', newY + '%')

        if(window.running) {
        
          requestAnimationFrame(animar)
        }
      }

      window.addEventListener(
        'message',
        e => {

          switch(e.data.type) {

            case 'RUN':

              window.running = true

              animar()

              break

            case 'STOP':

              window.running = false

              break

            default:

              break
          }
        }
      )

      setTimeout(() => {
      
        window.parent
        .postMessage({
          type: 'LOADED'
        })

      }, 10)

    ]]>
  </script>
</svg>
